@using Northwind.Models
@model IEnumerable<Discount>



<h2 class="mt-3"><i class="fas fa-list-ul"></i> Current Discounts</h2>

    @if (User?.Identity?.IsAuthenticated?? true) {
        if(User.IsInRole("northwind-employee")) 
        {
            <a asp-controller="Employee" asp-action="AddDiscount"> Add New Discount</a>
        }
    }
    
    <div class="list-group">

    @foreach (Discount d in Model)
    {  
        <a class="list-group-item list-group-item-action">
            @d.Title - <i style="opacity:.6;">@d.Description</i><br>
            <i>Discount amount: @d.DiscountPercent?.ToString("p2")</i><br>
            <i>Discount expires: @d.EndTime?.ToString("MM/dd/yyyy")</i><br>
            <i>Discount code: @d.Code</i>
            @if (d.StartTime > DateTime.Now){
                <hr /><div class="discount-inactive">Discount not active</div>
            } else if (d.EndTime < DateTime.Now){
                <hr /><div class="discount-expired">Discount expired</div>
            }
        </a>
           
           
        @if (User?.Identity?.IsAuthenticated?? true) {
            if(User.IsInRole("northwind-employee")) 
            {
                <a asp-controller="Employee" asp-action="RemoveDiscount" asp-route-id="@d.DiscountId">Remove Discount</a>
            }
        }

                   
        @if (User?.Identity?.IsAuthenticated?? true) {
            if(User.IsInRole("northwind-employee")) 
            {
                <button> Edit Discount</button>
            }
        }
    }

</div>

